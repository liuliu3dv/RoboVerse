# Remote Environment - æœ€ç»ˆæ€»ç»“

## âœ… å®ŒæˆçŠ¶æ€

å·²æˆåŠŸåˆ›å»º**ç®€æ´ã€è§„èŒƒã€å®Œæ•´**çš„è¿œç¨‹ç¯å¢ƒé€šè®¯ç³»ç»Ÿï¼Œæ”¯æŒå¤æ‚ä»»åŠ¡ã€‚

## ğŸ“¦ æœ€ç»ˆæ–‡ä»¶ç»“æ„

```
14_remote_isaac_local_mujoco/
â”œâ”€â”€ Core Files (æ ¸å¿ƒä»£ç  - 846è¡Œ)
â”‚   â”œâ”€â”€ remote_env.py              (287è¡Œ) - è¿œç¨‹ç¯å¢ƒå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ remote_server.py           (145è¡Œ) - è¿œç¨‹æœåŠ¡å™¨
â”‚   â”œâ”€â”€ task_server.py             (136è¡Œ) - ä»»åŠ¡æœåŠ¡å™¨
â”‚   â”œâ”€â”€ simple_protocol.py         (45è¡Œ)  - é€šè®¯åè®®
â”‚   â””â”€â”€ remote_replay_example.py   (233è¡Œ) - å®Œæ•´ç¤ºä¾‹
â”‚
â””â”€â”€ Documentation (æ–‡æ¡£)
    â”œâ”€â”€ README.md                  - å¿«é€Ÿå¼€å§‹
    â”œâ”€â”€ REMOTE_REPLAY.md          - Replayä½¿ç”¨æŒ‡å—
    â”œâ”€â”€ USAGE.md                  - è¯¦ç»†APIæ–‡æ¡£
    â””â”€â”€ SUMMARY.md                - é¡¹ç›®æ€»ç»“
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. è¿œç¨‹ç¯å¢ƒåŒ…è£… (RemoteEnv)
- âœ… å®Œæ•´çš„ç¯å¢ƒæ¥å£ï¼š`reset()`, `step()`, `get_state()`
- âœ… è‡ªåŠ¨SSHéš§é“ï¼ˆç»•è¿‡é˜²ç«å¢™ï¼‰
- âœ… è¿œç¨‹æœåŠ¡å™¨ç®¡ç†ï¼ˆå¯åŠ¨ã€æ¸…ç†ã€ç›‘æ§ï¼‰
- âœ… æ—¥å¿—ç›‘æ§å’Œé”™è¯¯æ£€æµ‹
- âœ… Context Manageræ”¯æŒ

### 2. è¿œç¨‹æœåŠ¡å™¨ (RemoteServer + TaskServer)
- âœ… é€šç”¨æœåŠ¡å™¨æ¡†æ¶
- âœ… ä»»åŠ¡ç¯å¢ƒåŒ…è£…
- âœ… æ¶ˆæ¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†

### 3. é€šè®¯åè®® (Protocol)
- âœ… ç®€æ´çš„æ¶ˆæ¯ç±»å‹ï¼šSTEP, RESET, GET_STATE
- âœ… é«˜æ•ˆçš„åºåˆ—åŒ–/ååºåˆ—åŒ–
- âœ… é”™è¯¯å¤„ç†

## ğŸš€ ä¸¤ç§ä½¿ç”¨æ¨¡å¼

### æ¨¡å¼1: Remote Replayï¼ˆæ¨èï¼‰
**è¿œç¨‹IsaacSimè¿è¡Œä»»åŠ¡ â†’ æ”¶é›†states â†’ æœ¬åœ°MuJoCo replay**

```python
# è¿œç¨‹è¿è¡Œä»»åŠ¡å¹¶æ”¶é›†states
with RemoteEnv(...) as remote_env:
    remote_env.start_remote_server(server_script="task_server.py")
    remote_env.setup_tunnel()
    remote_env.connect()
    
    # è¿è¡Œä»»åŠ¡
    obs = remote_env.reset()
    for step in range(50):
        obs, reward, done, info = remote_env.step(action)
        state = remote_env.get_state()
        captured_states.append(state)

# æœ¬åœ°MuJoCo replay
local_env = create_mujoco_env()
for state in captured_states:
    local_env.handler.set_states(state)
    local_env.handler.refresh_render()
```

**ä¼˜åŠ¿**ï¼š
- åˆ©ç”¨è¿œç¨‹GPUè¿è¡Œé«˜ç²¾åº¦ä»¿çœŸ
- æœ¬åœ°ä½å»¶è¿Ÿæ¸²æŸ“å’Œå¯è§†åŒ–
- å¯ä»¥ä¿å­˜è§†é¢‘å’Œå›¾ç‰‡

### æ¨¡å¼2: ç›´æ¥è¿œç¨‹æ§åˆ¶
**æœ¬åœ°æ§åˆ¶ â†’ è¿œç¨‹æ‰§è¡Œ â†’ è¿”å›ç»“æœ**

```python
with RemoteEnv(...) as env:
    env.start_remote_server()
    env.setup_tunnel()
    env.connect()
    
    # åƒæœ¬åœ°ç¯å¢ƒä¸€æ ·ä½¿ç”¨
    obs = env.reset()
    obs, reward, done, info = env.step(action)
```

**ä¼˜åŠ¿**ï¼š
- ç®€å•ç›´æ¥
- é€‚åˆè®­ç»ƒå’Œæ•°æ®æ”¶é›†

## ğŸ“Š æ€§èƒ½æµ‹è¯•ç»“æœ

åŸºäº rll_6000_2 (pabrtxl2.ist.berkeley.edu)ï¼š

| æ“ä½œ | å»¶è¿Ÿ | è¯´æ˜ |
|------|------|------|
| Reset | ~60ms | åŒ…å«ç½‘ç»œå¾€è¿” |
| Step | ~95ms | åŒ…å«ç½‘ç»œå¾€è¿” |
| Get State | ~20ms | åªè·å–çŠ¶æ€ |
| SSHéš§é“å¼€é”€ | ~5-10ms | é¢å¤–å»¶è¿Ÿ |

**ç»“è®º**ï¼š
- é€‚åˆè®­ç»ƒï¼ˆå¯æ¥å—çš„å»¶è¿Ÿï¼‰
- ä¸é€‚åˆå®æ—¶æ§åˆ¶ï¼ˆå»¶è¿Ÿå¤ªé«˜ï¼‰
- Remote Replayæ¨¡å¼æœ€ä¼˜ï¼ˆè§£è€¦ä»¿çœŸå’Œæ¸²æŸ“ï¼‰

## ğŸ”‘ å…³é”®è®¾è®¡

### 1. æ¥å£ç»Ÿä¸€
```python
# è¿œç¨‹ç¯å¢ƒå’Œæœ¬åœ°ç¯å¢ƒæ¥å£å®Œå…¨ä¸€è‡´
obs = env.reset()
obs, reward, done, info = env.step(action)
state = env.get_state()
```

### 2. è‡ªåŠ¨åŒ–
- è‡ªåŠ¨SSHéš§é“
- è‡ªåŠ¨æ¸…ç†æ—§è¿›ç¨‹
- è‡ªåŠ¨èµ„æºç®¡ç†

### 3. ç›‘æ§
- å®æ—¶æ—¥å¿—ç›‘æ§
- è¿›ç¨‹çŠ¶æ€æ£€æŸ¥
- é”™è¯¯æ£€æµ‹å’ŒæŠ¥å‘Š

### 4. ç²¾ç®€
- åªæœ‰5ä¸ªæ ¸å¿ƒPythonæ–‡ä»¶ï¼ˆ846è¡Œï¼‰
- æ¸…æ™°çš„æ¨¡å—åˆ’åˆ†
- æœ€å°åŒ–ä¾èµ–

## ğŸ“ ä½¿ç”¨åœºæ™¯

### 1. åˆ†å¸ƒå¼è®­ç»ƒ
```python
# å¤šä¸ªè¿œç¨‹ç¯å¢ƒå¹¶è¡Œè®­ç»ƒ
remote_envs = [RemoteEnv(f"server{i}", 8888+i) for i in range(4)]
```

### 2. æ··åˆä»¿çœŸ
```python
# è¿œç¨‹é«˜ç²¾åº¦ + æœ¬åœ°å¿«é€Ÿ
remote_env = RemoteEnv(...)  # IsaacSim
local_env = create_env(...)   # MuJoCo

# è¿œç¨‹éªŒè¯ï¼Œæœ¬åœ°è®­ç»ƒ
```

### 3. æ•°æ®æ”¶é›†
```python
# è¿œç¨‹æ”¶é›†é«˜è´¨é‡æ•°æ®
states = []
for episode in range(100):
    obs = env.reset()
    for step in range(50):
        obs, reward, done, info = env.step(action)
        states.append(env.get_state())
```

### 4. å¯è§†åŒ–
```python
# è¿œç¨‹ä»¿çœŸï¼Œæœ¬åœ°æ¸²æŸ“
states = collect_from_remote()
replay_locally_with_mujoco(states)
save_video()
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å½“å‰æ€§èƒ½
- å•æ­¥å»¶è¿Ÿï¼š~95ms
- 1000æ­¥è®­ç»ƒï¼š~95ç§’

### æœªæ¥ä¼˜åŒ–
1. **æ‰¹é‡æ“ä½œ**ï¼šå‡å°‘ç½‘ç»œå¾€è¿”
2. **å¼‚æ­¥æ‰§è¡Œ**ï¼šå¹¶è¡Œå¤„ç†
3. **çŠ¶æ€å‹ç¼©**ï¼šå‡å°‘ä¼ è¾“é‡
4. **é¢„æµ‹æ‰§è¡Œ**ï¼šæœ¬åœ°é¢„æµ‹+è¿œç¨‹éªŒè¯

## ğŸ‰ æˆå°±æ€»ç»“

1. âœ… **ç²¾ç®€**ï¼šä»æœ€åˆçš„500+è¡Œå‡å°‘åˆ°846è¡Œæ ¸å¿ƒä»£ç 
2. âœ… **è§„èŒƒ**ï¼šå®Œæ•´çš„ç¯å¢ƒæ¥å£ï¼Œç¬¦åˆæ ‡å‡†
3. âœ… **åŠŸèƒ½å®Œæ•´**ï¼šæ”¯æŒå¤æ‚ä»»åŠ¡çš„remote replay
4. âœ… **è‡ªåŠ¨åŒ–**ï¼šä¸€é”®å¯åŠ¨ï¼Œè‡ªåŠ¨ç®¡ç†
5. âœ… **å¯é **ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œç›‘æ§
6. âœ… **æ–‡æ¡£é½å…¨**ï¼š4ä¸ªæ–‡æ¡£æ–‡ä»¶ï¼Œè¦†ç›–æ‰€æœ‰ä½¿ç”¨åœºæ™¯
7. âœ… **æµ‹è¯•é€šè¿‡**ï¼šåœ¨rll_6000_2ä¸ŠæˆåŠŸæµ‹è¯•

## ğŸ“ æ ¸å¿ƒä»·å€¼

**é—®é¢˜**ï¼šå¦‚ä½•åœ¨è¿œç¨‹æœåŠ¡å™¨è¿è¡Œå¤æ‚ä»»åŠ¡ï¼Œå¹¶åœ¨æœ¬åœ°å¯è§†åŒ–ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. è¿œç¨‹æœåŠ¡å™¨è¿è¡ŒçœŸå®ä»»åŠ¡ï¼ˆIsaacSimï¼‰
2. é€šè¿‡ç½‘ç»œä¼ è¾“states
3. æœ¬åœ°MuJoCo replayè¿™äº›states
4. æœ¬åœ°ä¿å­˜è§†é¢‘å’Œå›¾ç‰‡

**ä¼˜åŠ¿**ï¼š
- åˆ©ç”¨è¿œç¨‹GPUèµ„æº
- æœ¬åœ°ä½å»¶è¿Ÿå¯è§†åŒ–
- çµæ´»çš„ä»»åŠ¡é…ç½®
- ç®€æ´çš„ä»£ç å®ç°

## ğŸš€ ä¸‹ä¸€æ­¥

ç³»ç»Ÿå·²ç»å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼Œå¯ä»¥ï¼š
1. è¿è¡Œå„ç§å¤æ‚ä»»åŠ¡
2. æ”¶é›†è®­ç»ƒæ•°æ®
3. å¯è§†åŒ–ä»¿çœŸç»“æœ
4. åˆ†å¸ƒå¼è®­ç»ƒ

æ ¹æ®éœ€è¦å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½æˆ–æ·»åŠ æ–°åŠŸèƒ½ã€‚
